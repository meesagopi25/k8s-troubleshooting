Below is your **complete Markdown / README-style training guide** for Kubernetes **Pending Pod Troubleshooting**.
You can copy/paste this directly into a `README.md` file and use it for team training or workshops.

---

# üß™ Kubernetes Troubleshooting Lab

## **Understanding & Fixing Pods Stuck in Pending State**

This lab provides **hands-on, practical scenarios** covering every major reason a Kubernetes Pod may be stuck in the `Pending` phase.
Each scenario includes:

* What the issue is
* How to reproduce it
* How to troubleshoot it
* How to fix it

Works on:

* Minikube
* KIND
* OpenShift Local
* OpenShift Sandbox
* Any Kubernetes cluster

---

# üß© **Prerequisites**

Ensure you can run:

```bash
kubectl get nodes
kubectl apply -f file.yaml
kubectl describe pod <pod>
kubectl describe node <node>
```

---

# üìò **Table of Contents**

1. [Insufficient CPU](#1-insufficient-cpu)
2. [Insufficient Memory](#2-insufficient-memory)
3. [Node Taints](#3-node-taints)
4. [Unbound PVC](#4-unbound-pvc)
5. [Node Selector Mismatch](#5-node-selector-mismatch)
6. [Anti-Affinity Rules](#6-anti-affinity-rules)
7. [SCC / PSP Security Restrictions](#7-securitycontextconstraints--psp-failure-openshift)
8. [ResourceQuota Violations](#8-resourcequota-violations)
9. [GPU Requests Not Allowed](#9-gpu-requests-not-allowed)
10. [Ephemeral Storage Violations](#10-ephemeral-storage-violations)
11. [Common Troubleshooting Commands](#11-common-troubleshooting-commands)

---

# 1Ô∏è‚É£ **Insufficient CPU**

### ‚ùå Problem

Pod requests more CPU than available in the cluster.

### YAML:

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: cpu-hog
spec:
  containers:
  - name: app
    image: nginx
    resources:
      requests:
        cpu: "10"
```

### Troubleshoot:

```bash
kubectl describe pod cpu-hog
```

**Expected event:**

```
0/3 nodes are available: insufficient cpu
```

### Fix:

Lower CPU request.

---

# 2Ô∏è‚É£ **Insufficient Memory**

### YAML:

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: memory-hog
spec:
  containers:
  - name: app
    image: nginx
    resources:
      requests:
        memory: "80Gi"
```

### Troubleshoot:

```bash
kubectl describe pod memory-hog
```

Expected:

```
insufficient memory
```

### Fix:

Request less memory.

---

# 3Ô∏è‚É£ **Node Taints**

### Add taint:

```bash
kubectl taint nodes <node> dedicated=backend:NoSchedule
```

### Pod that fails:

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: no-toleration
spec:
  containers:
  - name: app
    image: nginx
```

### Troubleshoot:

```bash
kubectl describe pod no-toleration
```

Expected:

```
node(s) had taint {dedicated=backend:NoSchedule}, that the pod didn't tolerate
```

### Fix:

Add toleration:

```yaml
tolerations:
- key: "dedicated"
  operator: "Equal"
  value: "backend"
  effect: "NoSchedule"
```

---

# 4Ô∏è‚É£ **Unbound PVC**

### Unbindable PVC:

```yaml
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: bad-pvc
spec:
  accessModes: ["ReadWriteOnce"]
  resources:
    requests:
      storage: 10Gi
  storageClassName: does-not-exist
```

### Pod that fails:

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: pvc-pod
spec:
  containers:
  - name: busy
    image: busybox
    command: ["sleep", "3600"]
    volumeMounts:
    - name: data
      mountPath: /data
  volumes:
  - name: data
    persistentVolumeClaim:
      claimName: bad-pvc
```

### Troubleshoot:

```
persistentvolumeclaim "bad-pvc" is not bound
```

### Fix:

Use correct StorageClass or create matching PV.

---

# 5Ô∏è‚É£ **Node Selector Mismatch**

### Failing Pod:

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: node-selector-fail
spec:
  nodeSelector:
    disktype: ssd
  containers:
  - name: app
    image: nginx
```

### Describe:

```
0 nodes match pod's node selector
```

### Fix:

Label a node:

```bash
kubectl label node <node> disktype=ssd
```

---

# 6Ô∏è‚É£ **Anti-Affinity Rules**

### Pod with impossible anti-affinity:

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: anti-affinity-fail
  labels:
    app: test
spec:
  affinity:
    podAntiAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
      - labelSelector:
          matchLabels:
            app: test
        topologyKey: "kubernetes.io/hostname"
  containers:
  - name: app
    image: nginx
```

### Describe:

```
pod anti-affinity rules not satisfied
```

### Fix:

Use preferred anti-affinity or reduce strictness.

---

# 7Ô∏è‚É£ **SecurityContextConstraints / PSP Failure (OpenShift)**

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: privileged-denied
spec:
  containers:
  - name: app
    image: nginx
    securityContext:
      privileged: true
```

### Describe:

```
pod is not allowed to use SecurityContextConstraints "privileged"
```

### Fix:

```bash
oc adm policy add-scc-to-user privileged -z default
```

---

# 8Ô∏è‚É£ **ResourceQuota Violations**

Example: Memory request over quota.

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: quota-memory-fail
spec:
  containers:
  - name: app
    image: nginx
    resources:
      requests:
        memory: "40Gi"
```

### Describe:

```
exceeded quota: compute-deploy, requested: requests.memory=40Gi
```

### Fix:

Reduce memory request.

---

# 9Ô∏è‚É£ **GPU Requests Not Allowed**

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: gpu-fail
spec:
  containers:
  - name: cuda
    image: nvidia/cuda
    resources:
      requests:
        nvidia.com/gpu: 1
```

### Error:

```
exceeded quota: requests.nvidia.com/gpu=1, limited: 0
```

### Fix:

Remove GPU request.

---

# üîü **Ephemeral Storage Violations**

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: ephemeral-fail
spec:
  containers:
  - name: app
    image: nginx
    resources:
      requests:
        ephemeral-storage: "20Gi"   # Limit is usually smaller
```

### Describe:

```
exceeded quota: requests.ephemeral-storage
```

---

# 1Ô∏è‚É£1Ô∏è‚É£ **Common Troubleshooting Commands**

### Check events:

```bash
kubectl describe pod <pod>
```

### Check node conditions:

```bash
kubectl describe node <node>
```

### Check taints:

```bash
kubectl describe node <node> | grep -i taint
```

### Check resource usage:

```bash
kubectl top pods
kubectl top nodes
```

### Check PVC:

```bash
kubectl get pvc
kubectl describe pvc <pvc>
```

---

# üéì **Conclusion**

This lab provides hands-on examples and troubleshooting practice for all major causes of Pods stuck in Pending:

* Resource shortages
* Taints
* PVC issues
* Node selector mismatch
* Affinity constraints
* Security restrictions
* ResourceQuota enforcement
* GPU & ephemeral storage limits

---

# ‚úÖ Want a downloadable ZIP containing all YAML files?

I can generate it for you ‚Äî just say **‚Äúyes, create ZIP‚Äù**.
